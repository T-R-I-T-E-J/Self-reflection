<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SYSTEM SELF-CHECK v1.0</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html, body {
      height: 100%;
      overflow: hidden;
    }

    body {
      font-family: "JetBrains Mono", monospace;
      background: #000;
      color: #e0e0e0;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.6s ease;
    }

    /* Scanline overlay for CRT effect */
    .scanlines {
      position: fixed;
      inset: 0;
      z-index: 100;
      pointer-events: none;
      background: repeating-linear-gradient(
        0deg,
        rgba(0, 0, 0, 0.1) 0px,
        rgba(0, 0, 0, 0.1) 1px,
        transparent 1px,
        transparent 2px
      );
    }

    /* Background layer for color + glitch */
    .bg-layer {
      position: fixed;
      inset: 0;
      z-index: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      pointer-events: none;
      overflow: hidden;
    }

    /* Big background word */
    #mode-word {
      font-size: clamp(4rem, 20vw, 14rem);
      font-weight: 700;
      letter-spacing: 0.5rem;
      color: rgba(255, 255, 255, 0.04);
      text-transform: uppercase;
      text-align: center;
      white-space: nowrap;
      user-select: none;
      transition: opacity 0.3s ease;
    }

    /* Terminal panel - landscape optimized */
    #terminal {
      position: relative;
      z-index: 10;
      background: rgba(0, 0, 0, 0.9);
      padding: 1.5rem 3rem;
      border-radius: 8px;
      border: 2px solid #888;
      width: 95%;
      max-width: 1000px;
      min-height: 280px;
      max-height: 85vh;
      overflow-y: auto;
      font-size: 14px;
      line-height: 1.5;
      white-space: pre-wrap;
      word-wrap: break-word;
    }

    /* Custom scrollbar */
    #terminal::-webkit-scrollbar {
      width: 8px;
    }
    #terminal::-webkit-scrollbar-track {
      background: rgba(0, 0, 0, 0.3);
    }
    #terminal::-webkit-scrollbar-thumb {
      background: #888;
      border-radius: 4px;
    }

    /* Blinking cursor */
    #cursor {
      display: inline-block;
      width: 10px;
      height: 18px;
      background: #fff;
      margin-left: 2px;
      animation: blink 1s step-end infinite;
      vertical-align: text-bottom;
    }

    @keyframes blink {
      0%, 50% { opacity: 1; }
      51%, 100% { opacity: 0; }
    }

    /* STATES: background + animation */

    body.state-idle {
      background: radial-gradient(ellipse at top center, #1a1a1a 0%, #000 60%);
    }

    body.state-stop {
      background: radial-gradient(ellipse at top center, #1a1a1a 0%, #000 60%);
    }

    body.state-stop .bg-layer {
      animation: glitch-bg 0.12s infinite;
    }

    body.state-stop #mode-word {
      color: rgba(255, 255, 255, 0.1);
      animation: stop-shake 0.1s infinite;
    }

    @keyframes stop-shake {
      0%   { transform: translate(0, 0) rotate(0deg); }
      25%  { transform: translate(-3px, 2px) rotate(-0.5deg); }
      50%  { transform: translate(3px, -2px) rotate(0.5deg); }
      75%  { transform: translate(-2px, -1px) rotate(-0.3deg); }
      100% { transform: translate(0, 0) rotate(0deg); }
    }

    body.state-continue {
      background: radial-gradient(ellipse at top center, #1a1a1a 0%, #000 60%);
    }

    body.state-continue .bg-layer {
      animation: pulse-bg 2.5s ease-in-out infinite;
    }

    body.state-continue #mode-word {
      color: rgba(255, 255, 255, 0.08);
      animation: mode-pulse 2.5s ease-in-out infinite;
    }

    body.state-start {
      background: radial-gradient(ellipse at top center, #1a1a1a 0%, #000 60%);
    }

    body.state-start .bg-layer {
      animation: glitch-soft 0.25s infinite, zoom-pulse 2s ease-in-out infinite;
    }

    body.state-start #mode-word {
      color: rgba(255, 255, 255, 0.1);
      animation: mode-pulse 1s ease-in-out infinite;
    }

    /* Background media layers */
    .bg-media {
      position: fixed;
      inset: 0;
      z-index: 1;
      opacity: 0;
      transition: opacity 1.5s ease;
      pointer-events: none;
    }

    .bg-media.active {
      opacity: 1;
    }

    .bg-media img,
    .bg-media video {
      width: 100%;
      height: 100%;
      object-fit: contain;
      filter: brightness(0.7) grayscale(1);
    }

    .bg-media::after {
      content: "";
      position: absolute;
      inset: 0;
      background: radial-gradient(ellipse at center, transparent 50%, rgba(0,0,0,0.6) 100%);
      pointer-events: none;
    }

    /* Make terminal semi-transparent when background media is active */
    .bg-media.active ~ .bg-layer ~ #terminal,
    body:has(.bg-media.active) #terminal {
      background: rgba(0, 0, 0, 0.75);
    }

    /* Flash overlay */
    .green-flash {
      position: fixed;
      inset: 0;
      z-index: 200;
      background: #fff;
      opacity: 0;
      pointer-events: none;
    }

    .green-flash.flash {
      animation: flashBang 0.4s ease-out forwards;
    }

    @keyframes flashBang {
      0% { opacity: 0.9; }
      100% { opacity: 0; }
    }

    /* Vertical scanline sweep */
    .vertical-scanline {
      position: fixed;
      top: 0;
      left: -100px;
      width: 100px;
      height: 100%;
      z-index: 150;
      background: linear-gradient(90deg, 
        transparent 0%, 
        rgba(255, 255, 255, 0.1) 30%,
        rgba(255, 255, 255, 0.5) 50%,
        rgba(255, 255, 255, 0.1) 70%,
        transparent 100%
      );
      opacity: 0;
      pointer-events: none;
    }

    .vertical-scanline.sweep {
      animation: scanSweep 0.8s ease-in-out forwards;
    }

    @keyframes scanSweep {
      0% { left: -100px; opacity: 1; }
      100% { left: calc(100% + 100px); opacity: 1; }
    }

    /* Terminal glitch effect */
    .terminal-glitch {
      animation: terminalGlitchAnim 0.3s ease-out !important;
    }

    @keyframes terminalGlitchAnim {
      0% { transform: translate(0, 0) skewX(0deg); }
      10% { transform: translate(-5px, 3px) skewX(-3deg); }
      20% { transform: translate(5px, -3px) skewX(3deg); }
      30% { transform: translate(-3px, -2px) skewX(-2deg); }
      40% { transform: translate(3px, 2px) skewX(2deg); }
      50% { transform: translate(-2px, 1px) skewX(-1deg); }
      60% { transform: translate(2px, -1px) skewX(1deg); }
      70% { transform: translate(-1px, 2px) skewX(-0.5deg); }
      80% { transform: translate(1px, -2px) skewX(0.5deg); }
      90% { transform: translate(0, 1px) skewX(0deg); }
      100% { transform: translate(0, 0) skewX(0deg); }
    }

    /* Enhanced start state with image bg */
    body.state-start .bg-media img {
      filter: brightness(0.6) grayscale(1);
    }

    /* Enhanced continue state with video bg */
    body.state-continue .bg-media video {
      filter: brightness(0.5) grayscale(1);
    }

    @keyframes mode-pulse {
      0%   { opacity: 0.8; transform: scale(1); }
      50%  { opacity: 1; transform: scale(1.02); }
      100% { opacity: 0.8; transform: scale(1); }
    }

    /* Glitch keyframes */

    @keyframes glitch-bg {
      0%   { transform: translate(0, 0) scale(1) skewX(0deg); filter: brightness(1); }
      10%  { transform: translate(-8px, 4px) scale(1.01) skewX(-2deg); filter: brightness(1.2); }
      20%  { transform: translate(6px, -6px) scale(0.99) skewX(1deg); filter: brightness(0.8); }
      30%  { transform: translate(-4px, -3px) scale(1.005) skewX(-1deg); filter: brightness(1.1); }
      40%  { transform: translate(5px, 5px) scale(0.995) skewX(2deg); filter: brightness(0.9); }
      50%  { transform: translate(-6px, 2px) scale(1.008) skewX(-1.5deg); filter: brightness(1.15); }
      60%  { transform: translate(4px, -4px) scale(0.992) skewX(1.5deg); filter: brightness(0.85); }
      70%  { transform: translate(-3px, 6px) scale(1.003) skewX(-0.5deg); filter: brightness(1.05); }
      80%  { transform: translate(7px, -2px) scale(0.997) skewX(2.5deg); filter: brightness(0.95); }
      90%  { transform: translate(-5px, -5px) scale(1.006) skewX(-2deg); filter: brightness(1.1); }
      100% { transform: translate(0, 0) scale(1) skewX(0deg); filter: brightness(1); }
    }

    @keyframes glitch-soft {
      0%   { filter: brightness(1); transform: translate(0, 0) scale(1); }
      20%  { filter: brightness(1.1); transform: translate(2px, -2px) scale(1.005); }
      40%  { filter: brightness(0.95); transform: translate(-3px, 1px) scale(0.998); }
      60%  { filter: brightness(1.05); transform: translate(1px, 3px) scale(1.002); }
      80%  { filter: brightness(1.08); transform: translate(-2px, -1px) scale(0.997); }
      100% { filter: brightness(1); transform: translate(0, 0) scale(1); }
    }

    @keyframes pulse-bg {
      0%   { filter: brightness(1) saturate(1); transform: scale(1); }
      25%  { filter: brightness(1.1) saturate(1.1); transform: scale(1.005); }
      50%  { filter: brightness(1.25) saturate(1.2); transform: scale(1.015); }
      75%  { filter: brightness(1.1) saturate(1.1); transform: scale(1.005); }
      100% { filter: brightness(1) saturate(1); transform: scale(1); }
    }

    @keyframes zoom-pulse {
      0%   { transform: scale(1); filter: brightness(1); }
      50%  { transform: scale(1.03); filter: brightness(1.1); }
      100% { transform: scale(1); }
    }

    /* Text flicker and glitch for stop state */
    body.state-stop #terminal {
      animation: text-flicker 0.08s infinite, terminal-glitch 0.3s infinite;
    }

    @keyframes text-flicker {
      0%   { opacity: 1; }
      25%  { opacity: 0.88; }
      50%  { opacity: 0.95; }
      75%  { opacity: 0.85; }
      100% { opacity: 1; }
    }

    @keyframes terminal-glitch {
      0%   { transform: translate(0, 0) skewX(0deg); }
      10%  { transform: translate(-2px, 1px) skewX(-0.5deg); }
      20%  { transform: translate(2px, -1px) skewX(0.3deg); }
      30%  { transform: translate(0, 0) skewX(0deg); }
      40%  { transform: translate(1px, 2px) skewX(-0.2deg); }
      50%  { transform: translate(-1px, -1px) skewX(0.4deg); }
      60%  { transform: translate(0, 0) skewX(0deg); }
      70%  { transform: translate(3px, 0) skewX(-0.3deg); }
      80%  { transform: translate(-2px, 1px) skewX(0.2deg); }
      90%  { transform: translate(1px, -2px) skewX(-0.1deg); }
      100% { transform: translate(0, 0) skewX(0deg); }
    }

    /* Glitch line effect */
    body.state-stop .bg-layer::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: rgba(255, 255, 255, 0.8);
      animation: scan-line 0.1s linear infinite;
      z-index: 2;
    }

    @keyframes scan-line {
      0%   { top: 0%; opacity: 1; }
      50%  { opacity: 0.5; }
      100% { top: 100%; opacity: 1; }
    }

    /* Loading bar styling */
    .loading-bar {
      display: inline-block;
      width: 300px;
      height: 20px;
      background: rgba(255, 255, 255, 0.1);
      border: 1px solid #888;
      position: relative;
      margin-top: 8px;
    }

    .loading-fill {
      height: 100%;
      background: linear-gradient(90deg, #e0e0e0, #aaa);
      width: 0%;
      transition: width 0.08s linear;
    }

    /* Landscape overlay - hidden by default */
    .rotate-prompt {
      display: none;
      position: fixed;
      inset: 0;
      z-index: 1000;
      background: #000;
      color: #e0e0e0;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 2rem;
      text-align: center;
      padding: 2rem;
    }

    .rotate-prompt .rotate-icon {
      font-size: 4rem;
      animation: rotate-hint 2s ease-in-out infinite;
    }

    .rotate-prompt p {
      font-size: 1.2rem;
      opacity: 0.9;
    }

    @keyframes rotate-hint {
      0%, 100% { transform: rotate(0deg); }
      25% { transform: rotate(-15deg); }
      75% { transform: rotate(15deg); }
    }

    /* Show rotate prompt on portrait mobile */
    @media (max-width: 768px) and (orientation: portrait) {
      .rotate-prompt {
        display: flex;
      }
      
      #terminal,
      .bg-layer,
      .scanlines {
        display: none;
      }
    }

    /* Landscape mobile styles */
    @media (max-height: 500px) and (orientation: landscape) {
      #terminal {
        padding: 1rem 2rem;
        font-size: 12px;
        min-height: auto;
        max-height: 90vh;
      }
      
      #mode-word {
        font-size: clamp(3rem, 15vw, 8rem);
      }
    }

    /* Tablet landscape */
    @media (min-width: 768px) and (max-width: 1024px) {
      #terminal {
        max-width: 90%;
        font-size: 13px;
      }
    }

    /* Desktop widescreen */
    @media (min-width: 1200px) {
      #terminal {
        max-width: 1100px;
        font-size: 15px;
        padding: 2rem 4rem;
      }
    }

    /* Input indicator */
    .prompt {
      color: #e0e0e0;
    }

    /* Help menu grid */
    .help-menu {
      display: grid;
      grid-template-columns: 120px 1fr;
      gap: 0.5rem 2rem;
      padding: 1.2rem 1.8rem;
      border: 2px solid currentColor;
      margin: 0.8rem 0;
      background: rgba(255, 255, 255, 0.03);
      white-space: normal;
      font-family: "JetBrains Mono", monospace;
    }

    .help-menu .help-title {
      grid-column: 1 / -1;
      text-align: center;
      font-weight: 700;
      font-size: 1.1em;
      padding-bottom: 0.8rem;
      margin-bottom: 0.5rem;
      border-bottom: 1px solid currentColor;
      letter-spacing: 0.15em;
    }

    .help-menu .cmd {
      font-weight: 700;
      white-space: nowrap;
      color: inherit;
    }

    .help-menu .desc {
      opacity: 0.75;
      font-size: 0.95em;
    }

    body.state-stop .help-menu,
    body.state-continue .help-menu,
    body.state-start .help-menu {
      background: rgba(255, 255, 255, 0.05);
    }
  </style>
</head>
<body class="state-idle">
  <!-- Rotate prompt for portrait mobile -->
  <div class="rotate-prompt">
    <div class="rotate-icon">ðŸ“±</div>
    <p>ROTATE DEVICE TO LANDSCAPE</p>
    <p style="opacity: 0.5; font-size: 0.9rem;">Best experienced in widescreen</p>
  </div>

  <div class="scanlines"></div>
  
  <!-- Background media layers -->
  <div class="bg-media" id="bg-image">
    <img src="cert.png" alt="Certification Roadmap">
  </div>
  <div class="bg-media" id="bg-video">
    <video id="thm-video" loop muted playsinline>
      <source src="thm.mp4" type="video/mp4">
    </video>
  </div>
  
  <!-- Green flash overlay -->
  <div class="green-flash" id="green-flash"></div>
  
  <!-- Vertical scanline -->
  <div class="vertical-scanline" id="vertical-scanline"></div>
  
  <div class="bg-layer">
    <div id="mode-word"></div>
  </div>

  <pre id="terminal"></pre>

  <script>
    const terminal = document.getElementById("terminal");
    const modeWord = document.getElementById("mode-word");
    const bgImage = document.getElementById("bg-image");
    const bgVideo = document.getElementById("bg-video");
    const thmVideo = document.getElementById("thm-video");
    const greenFlash = document.getElementById("green-flash");
    const verticalScanline = document.getElementById("vertical-scanline");

    let progress = 0;
    let input = "";
    let readyForInput = false;
    let terminalContent = "";

    function setState(state, word) {
      document.body.classList.remove("state-idle", "state-stop", "state-continue", "state-start");
      document.body.classList.add("state-" + state);
      modeWord.textContent = word || "";
    }

    // Hide all background media
    function hideAllBgMedia() {
      bgImage.classList.remove("active");
      bgVideo.classList.remove("active");
      thmVideo.pause();
      thmVideo.currentTime = 0;
    }

    // Show certification image background
    function showCertBackground() {
      hideAllBgMedia();
      bgImage.classList.add("active");
    }

    // Show video background
    function showVideoBackground() {
      hideAllBgMedia();
      bgVideo.classList.add("active");
      thmVideo.play().catch(() => {}); // Autoplay might be blocked
    }

    // Trigger green flash effect
    function triggerGreenFlash() {
      greenFlash.classList.remove("flash");
      void greenFlash.offsetWidth; // Force reflow
      greenFlash.classList.add("flash");
    }

    // Trigger vertical scanline sweep
    function triggerScanlineSweep() {
      verticalScanline.classList.remove("sweep");
      void verticalScanline.offsetWidth; // Force reflow
      verticalScanline.classList.add("sweep");
    }

    // Trigger terminal glitch effect
    function triggerTerminalGlitch() {
      terminal.classList.add("terminal-glitch");
      setTimeout(() => {
        terminal.classList.remove("terminal-glitch");
      }, 300);
    }

    // Full transition sequence
    function triggerTransitionSequence(showBgCallback) {
      triggerTerminalGlitch();
      setTimeout(() => {
        triggerGreenFlash();
        showBgCallback();
      }, 150);
      setTimeout(() => {
        triggerScanlineSweep();
      }, 300);
    }

    function updateTerminal() {
      terminal.innerHTML = terminalContent + '<span id="cursor"></span>';
      // Auto-scroll to bottom
      terminal.scrollTop = terminal.scrollHeight;
    }

    function print(text) {
      terminalContent += text;
      updateTerminal();
    }

    function println(text = "") {
      terminalContent += text + "\n";
      updateTerminal();
    }

    function clearTerminal() {
      terminalContent = "";
      updateTerminal();
    }

    // Typewriter effect for dramatic text
    async function typeText(text, delay = 30) {
      for (let i = 0; i < text.length; i++) {
        terminalContent += text[i];
        updateTerminal();
        await sleep(delay);
      }
    }

    function sleep(ms) {
      return new Promise(resolve => setTimeout(resolve, ms));
    }

    async function startLoading() {
      setState("idle", "");
      
      // Initial boot sequence
      await typeText("SYSTEM SELF-CHECK v1.0\n", 25);
      await sleep(200);
      await typeText("â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n", 5);
      await sleep(300);
      await typeText("> Initializing core systems...\n", 20);
      await sleep(400);
      await typeText("> Loading modules", 25);
      
      // Dots animation
      for (let i = 0; i < 3; i++) {
        await sleep(300);
        print(".");
      }
      println("");
      await sleep(200);
      
      println("> LOADING SYSTEM...\n");
      
      // Progress bar
      const barWidth = 40;
      
      const loadInterval = setInterval(() => {
        progress += Math.random() * 4 + 1;
        if (progress > 100) progress = 100;
        
        const filled = Math.floor((progress / 100) * barWidth);
        const empty = barWidth - filled;
        const bar = "â–ˆ".repeat(filled) + "â–‘".repeat(empty);
        const percent = Math.floor(progress).toString().padStart(3, " ");
        
        // Update only the progress line
        const lines = terminalContent.split("\n");
        const lastLineIndex = lines.length - 1;
        lines[lastLineIndex] = `   [${bar}] ${percent}%`;
        terminalContent = lines.join("\n");
        updateTerminal();
        
        if (progress >= 100) {
          clearInterval(loadInterval);
          setTimeout(showReady, 600);
        }
      }, 60);
      
      println(""); // Add line for progress bar
    }

    async function showReady() {
      println("\n");
      await typeText("âœ“ All systems operational\n", 20);
      await sleep(200);
      await typeText("â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n", 5);
      await sleep(300);
      
      // Big SYSTEM READY with glow effect
      println("");
      await typeText("   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ–ˆâ•—\n", 3);
      await typeText("   â–ˆâ–ˆâ•”â•â•â•â•â•â•šâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•”â•â•â•â•â•â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ•‘\n", 3);
      await typeText("   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•”â• â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ•‘\n", 3);
      await typeText("   â•šâ•â•â•â•â–ˆâ–ˆâ•‘  â•šâ–ˆâ–ˆâ•”â•  â•šâ•â•â•â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘\n", 3);
      await typeText("   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘ â•šâ•â• â–ˆâ–ˆâ•‘\n", 3);
      await typeText("   â•šâ•â•â•â•â•â•â•   â•šâ•â•   â•šâ•â•â•â•â•â•â•   â•šâ•â•   â•šâ•â•â•â•â•â•â•â•šâ•â•     â•šâ•â•\n", 3);
      
      await sleep(200);
      
      await typeText("   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—\n", 3);
      await typeText("   â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â•šâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•”â•\n", 3);
      await typeText("   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•”â• \n", 3);
      await typeText("   â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘  â•šâ–ˆâ–ˆâ•”â•  \n", 3);
      await typeText("   â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•   â–ˆâ–ˆâ•‘   \n", 3);
      await typeText("   â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â•â•â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â•    â•šâ•â•   \n", 3);
      
      println("");
      await sleep(400);
      await typeText('> TYPE "help" TO BEGIN\n', 30);
      await sleep(200);
      println("â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€");
      print("\n> ");
      
      readyForInput = true;
      input = "";
    }

    function processCommand(cmd) {
      cmd = cmd.trim().toLowerCase();
      
      // Normalize commands - accept with or without parentheses
      if (cmd === "stop" || cmd === "stop()") cmd = "stop()";
      if (cmd === "start" || cmd === "start()") cmd = "start()";
      if (cmd === "continue" || cmd === "continue()") cmd = "continue()";

      if (cmd === "help" || cmd === "help()") {
        hideAllBgMedia();
        println("");
        terminalContent += `<div class="help-menu">
<div class="help-title">AVAILABLE COMMANDS</div>
<span class="cmd">stop</span><span class="desc">Terminate old patterns</span>
<span class="cmd">continue</span><span class="desc">Load TryHackMe training</span>
<span class="cmd">start</span><span class="desc">Show certification roadmap</span>
<span class="cmd">clear</span><span class="desc">Clear terminal</span>
<span class="cmd">help</span><span class="desc">Show this menu</span>
</div>`;
        updateTerminal();
        print("\n> ");
        setState("idle", "");
      } else if (cmd === "stop()") {
        hideAllBgMedia();
        readyForInput = false; // Disable input during animation
        println("");
        println("â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“");
        println("â–“                                       â–“");
        println("â–“   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—   â–“");
        println("â–“   â–ˆâ–ˆâ•”â•â•â•â•â•â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—  â–“");
        println("â–“   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•  â–“");
        println("â–“   â•šâ•â•â•â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•   â–“");
        println("â–“   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘       â–“");
        println("â–“   â•šâ•â•â•â•â•â•â•   â•šâ•â•    â•šâ•â•â•â•â•â• â•šâ•â•       â–“");
        println("â–“                                       â–“");
        println("â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“");
        println("");
        println(">> Terminating old patterns...");
        println(">> "); // Start progress line
        setState("stop", "STOP");
        
        // Animated progress bar for stop
        let stopProgress = 0;
        const stopBarWidth = 36;
        const stopInterval = setInterval(() => {
          stopProgress += Math.random() * 6 + 3;
          if (stopProgress > 100) stopProgress = 100;
          
          const filled = Math.floor((stopProgress / 100) * stopBarWidth);
          const empty = stopBarWidth - filled;
          const bar = "â–ˆ".repeat(filled) + "â–‘".repeat(empty);
          const percent = Math.floor(stopProgress).toString().padStart(3, " ");
          
          // Update the progress line
          const lines = terminalContent.split("\n");
          const lastLineIndex = lines.length - 1;
          lines[lastLineIndex] = `>> [${bar}] ${percent}%`;
          terminalContent = lines.join("\n");
          updateTerminal();
          
          if (stopProgress >= 100) {
            clearInterval(stopInterval);
            setTimeout(() => {
              println("");
              println(">> Breaking the cycle. Pattern stopped.");
              println("â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€");
              print("\n> ");
              readyForInput = true; // Re-enable input
            }, 400);
          }
        }, 40);
      } else if (cmd === "continue()") {
        readyForInput = false; // Disable input during animation
        println("");
        println("â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘");
        println("â–‘                                       â–‘");
        println("â–‘    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–‘");
        println("â–‘   â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–‘");
        println("â–‘   â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–‘");
        println("â–‘   â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–‘");
        println("â–‘   â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–‘");
        println("â–‘    â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•â• â•šâ•â•  â•šâ•â•â•â•   â•šâ•â•   â–‘");
        println("â–‘                                       â–‘");
        println("â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘");
        println("");
        println(">> Loading TryHackMe training environment...");
        println(">> "); // Start progress line
        setState("continue", "CONTINUE");
        
        // Animated progress bar for continue (slower, steady pace)
        let contProgress = 0;
        const contBarWidth = 36;
        const contInterval = setInterval(() => {
          contProgress += Math.random() * 3 + 2;
          if (contProgress > 100) contProgress = 100;
          
          const filled = Math.floor((contProgress / 100) * contBarWidth);
          const empty = contBarWidth - filled;
          const bar = "â–ˆ".repeat(filled) + "â–‘".repeat(empty);
          const percent = Math.floor(contProgress).toString().padStart(3, " ");
          
          // Update the progress line
          const lines = terminalContent.split("\n");
          const lastLineIndex = lines.length - 1;
          lines[lastLineIndex] = `>> [${bar}] ${percent}%`;
          terminalContent = lines.join("\n");
          updateTerminal();
          
          if (contProgress >= 100) {
            clearInterval(contInterval);
            // Trigger the transition sequence with video
            triggerTransitionSequence(showVideoBackground);
            setTimeout(() => {
              println("");
              println(">> TryHackMe environment loaded.");
              println(">> Hands-on practice in progress...");
              println(">> Keep hacking. Keep learning.");
              println("â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€");
              print("\n> ");
              readyForInput = true; // Re-enable input
            }, 800);
          }
        }, 60);
      } else if (cmd === "start()") {
        readyForInput = false; // Disable input during animation
        println("");
        println("â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—");
        println("â•‘                                       â•‘");
        println("â•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—");
        println("â•‘   â–ˆâ–ˆâ•”â•â•â•â•â•â•šâ•â•â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â•šâ•â•â–ˆâ–ˆâ•”â•â•â•");
        println("â•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•   â–ˆâ–ˆâ•‘   ");
        println("â•‘   â•šâ•â•â•â•â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•‘   ");
        println("â•‘   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘   ");
        println("â•‘   â•šâ•â•â•â•â•â•â•   â•šâ•â•   â•šâ•â•  â•šâ•â•â•šâ•â•  â•šâ•â•   â•šâ•â•   ");
        println("â•‘                                       â•‘");
        println("â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•");
        println("");
        println(">> Initializing certification pathway...");
        println(">> "); // Start progress line
        setState("start", "START");
        
        // Animated progress bar
        let startProgress = 0;
        const barWidth = 36;
        const startInterval = setInterval(() => {
          startProgress += Math.random() * 5 + 2;
          if (startProgress > 100) startProgress = 100;
          
          const filled = Math.floor((startProgress / 100) * barWidth);
          const empty = barWidth - filled;
          const bar = "â–ˆ".repeat(filled) + "â–‘".repeat(empty);
          const percent = Math.floor(startProgress).toString().padStart(3, " ");
          
          // Update the progress line
          const lines = terminalContent.split("\n");
          const lastLineIndex = lines.length - 1;
          lines[lastLineIndex] = `>> [${bar}] ${percent}%`;
          terminalContent = lines.join("\n");
          updateTerminal();
          
          if (startProgress >= 100) {
            clearInterval(startInterval);
            // Trigger the transition sequence
            triggerTransitionSequence(showCertBackground);
            setTimeout(() => {
              println("");
              println(">> Loading certification roadmap...");
              println(">> ITF+ â†’ A+ â†’ Network+ â†’ Security+ â†’ PenTest+/CySA+ â†’ SecurityX");
              println(">> Your path to mastery is clear.");
              println("â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€");
              print("\n> ");
              readyForInput = true; // Re-enable input
            }, 800);
          }
        }, 50);
      } else if (cmd === "clear") {
        hideAllBgMedia();
        clearTerminal();
        println("Terminal cleared.");
        println("â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€");
        print("\n> ");
        setState("idle", "");
      } else if (cmd === "exit" || cmd === "exit()") {
        hideAllBgMedia();
        println("");
        println(">> SESSION TERMINATED");
        println(">> Thank you for using SYSTEM SELF-CHECK");
        println("â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€");
        readyForInput = false;
        setState("idle", "");
      } else if (cmd === "") {
        print("\n> ");
      } else {
        hideAllBgMedia();
        println("");
        println(`>> Unknown command: "${cmd}"`);
        println('>> Type "help" for available commands.');
        println("â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€");
        print("\n> ");
        setState("idle", "");
      }
    }

    document.addEventListener("keydown", (e) => {
      if (!readyForInput) return;

      if (e.key === "Enter") {
        e.preventDefault();
        processCommand(input);
        input = "";
      } else if (e.key === "Backspace") {
        e.preventDefault();
        if (input.length > 0) {
          input = input.slice(0, -1);
          terminalContent = terminalContent.slice(0, -1);
          updateTerminal();
        }
      } else if (e.key === "Tab") {
        e.preventDefault();
      } else if (e.key.length === 1 && !e.ctrlKey && !e.metaKey && !e.altKey) {
        e.preventDefault();
        input += e.key;
        print(e.key);
      }
    });

    // Start the experience
    startLoading();
  </script>
</body>
</html>

